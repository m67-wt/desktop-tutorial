<script>
   let myGlobalX = 0
   let myScore = 10
   let myGun01
   let myGun02
   let myShooting = 1
   let enemiesKilled = 0
   let hasKey = false

function myHitOther(my1,my2){
   let obj1 = document.getElementById(my1)
   let obj2 = document.getElementById(my2)
   if (obj1.style.display == 'none' || obj2.style.display == 'none') return false

   left1   = parseInt(obj1.style.left)
   right1  = left1 + parseInt(obj1.style.width)
   top1    = parseInt(obj1.style.top)   
   bottom1 = top1   + parseInt(obj1.style.height)
   left2   = parseInt(obj2.style.left)
   right2  = left2 + parseInt(obj2.style.width)
   top2    = parseInt(obj2.style.top)   
   bottom2 = top2   + parseInt(obj2.style.height)
   if ((right1 >= left2) && (bottom1 >= top2) && (left1 <= right2) && (top1 <= bottom2)){
       return true
   }
}

function myCheckHit(){
   document.all.myText01.value = 'Score: ' + myScore + ' | Killed: ' + enemiesKilled + '/2'

   if (myHitOther('myImg01','myImg02') || myHitOther('myImg01','myImg03')){
      document.getElementById('myImg01').style.left = '20px'
      myScore -= 1
   }

   if (myHitOther('myBullet01','myImg02') || myHitOther('myBullet02','myImg02')){
      document.getElementById('myImg02').style.display = 'none'
      enemiesKilled++
      myScore += 5
   }

   if (myHitOther('myBullet01','myImg03') || myHitOther('myBullet02','myImg03')){
      document.getElementById('myImg03').style.display = 'none'
      enemiesKilled++
      myScore += 5
   }

   if (myHitOther('myImg01','myKey')){
      document.getElementById('myKey').style.display = 'none'
      hasKey = true
   }

   if (enemiesKilled >= 2 && hasKey){
      document.getElementById('myImg04').style.backgroundColor = 'green'
   }

   if (myHitOther('myImg01','myImg04') && enemiesKilled >= 2 && hasKey){
      location = 'https://m67-wt.github.io/desktop-tutorial/public/maze game/maze.html'
   }

   if (myScore <= 0){
    location.reload()
   }
}

function myShoot(){
    if (myShooting > 2) myShooting = 1
    let bulletName = (myShooting == 1) ? 'myBullet01' : 'myBullet02'
    let gunVar = (myShooting == 1) ? myGun01 : myGun02
    
    myShooting++
    document.getElementById(bulletName).style.left = document.getElementById('myImg01').style.left
    document.getElementById(bulletName).style.top  = document.getElementById('myImg01').style.top
    
    clearInterval(gunVar)
    let moveBullet = setInterval(function(){
        document.getElementById(bulletName).style.left = parseInt(document.getElementById(bulletName).style.left) + 15 + 'px'
        myCheckHit()
        if (parseInt(document.getElementById(bulletName).style.left) > 2000) clearInterval(moveBullet)
    }, 20)
}
</script>

<body id="myBody" style="margin:0; background-image: url('assets/pixel_light_grey_mosaic.jpg'); background-size: cover; background-attachment: fixed;" onkeydown="{
   let key = event.key.toLowerCase()
   let p = document.getElementById('myImg01')
   if (key == 'w') p.style.top = parseInt(p.style.top) - 10 + 'px'
   if (key == 'a') p.style.left = parseInt(p.style.left) - 10 + 'px'
   if (key == 's') p.style.top = parseInt(p.style.top) + 10 + 'px'
   if (key == 'd') p.style.left = parseInt(p.style.left) + 10 + 'px'
   if (key == ' ') myShoot()
   myCheckHit()
}">

<h1 align=center>T4A06 Game by Fred</h1>
<div align=center>
   <input id="myText01" type=text value="" size=40 readonly style="background:transparent; border:none; text-align:center; font-weight:bold;">
   <p>Kill enemies & get Key to open the Green Exit!</p>
</div>

<div id="myFloor" style="position:fixed; bottom:0; width:100%; height:80px; background-image: url('assets/lvl_floor texture.png');"></div>

<img id="myImg01" src="assets/charater.png" style="position:absolute; width:80px; height:80px; left: 10px; top:200px;">

<img id="myImg02" src="assets/charater.png" style="position:absolute; width:80px; height:80px; left:400px; top:150px;">
<img id="myImg03" src="assets/charater.png" style="position:absolute; width:80px; height:80px; left:600px; top:300px;">

<img id="myKey" src="assets/wall textures-5.png" style="position:absolute; width:40px; height:40px; left:700px; top:100px;">

<div id="myImg04" style="position:absolute; width:80px; height:100px; left:850px; top:250px; background-color:red; border:2px solid black; text-align:center; line-height:100px; font-weight:bold; color:white;">EXIT</div>

<img id="myBullet01" src="assets/charater.png" style="position:absolute; width:15px; height:15px; left: -200px;">
<img id="myBullet02" src="assets/charater.png" style="position:absolute; width:15px; height:15px; left: -200px;"> 

</body>
